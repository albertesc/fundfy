---
import image from "../assets/faqs.jpg";
---

<section class="pb-12 md:py-24 bg-[#F2F3F3] text-dark" id="faqs">
  <div class="container mx-auto px-8 hidden md:block">
    <div class="flex flex-wrap justify-end -mx-8">
      <div class="w-full md:w-7/12 px-8">
        <h2 class="mb-12 md:mb-24 text-xl">
          — <strong>FAQs</strong> Preguntas frequetes
        </h2>
      </div>
    </div>
  </div>
  <div class="relative">
    <div class="md:absolute inset-y-0 left-0 w-full md:w-1/3 h-full">
      <img
        src={image.src}
        alt=""
        class="object-cover object-center w-full h-full md:rounded-br-3xl md:rounded-tr-3xl mb-12 md:mb-0"
      />
    </div>
    <div class="container mx-auto px-8">
      <div class="flex flex-wrap justify-end -mx-8">
        <div class="w-full md:w-7/12 px-8">
          <h2 class="mb-12 md:mb-24 text-xl md:hidden">
            — <strong>FAQs</strong> Preguntas frequetes
          </h2>
          <h3
            class="text-[40px] md:text-[56px] text-balance font-light leading-none mb-16"
          >
            Todo lo que necesitas saber
          </h3>
          <div class="accordion border-b border-dark w-full">
            <button
              aria-expanded="false"
              aria-controls="faq1"
              class="cursor-pointer font-semibold mb-5 pt-5 border-t border-dark w-full flex justify-between items-center text-left"
            >
              ¿Qué tipo de activos financieros puedo custodiar con Fundfy?
              <span class="inline-block rotate-90">➔</span>
            </button>
            <div id="faq1" class="panel" role="region" aria-hidden="true">
              <p class="pb-5">
                Fundfy permite la custodia tanto de activos tradicionales como
                digitales, incluyendo criptomonedas, brindando máxima seguridad
                y acceso verificado.
              </p>
            </div>

            <button
              aria-expanded="false"
              aria-controls="faq2"
              class="cursor-pointer font-semibold mb-5 pt-5 border-t border-dark w-full flex justify-between items-center text-left"
            >
              ¿Qué diferencia a Fundfy de otras plataformas de gestión de
              activos?
              <span class="inline-block rotate-90">➔</span>
            </button>
            <div id="faq2" class="panel" role="region" aria-hidden="true">
              <p class="pb-5">
                Fundfy permite la custodia tanto de activos tradicionales como
                digitales, incluyendo criptomonedas, brindando máxima seguridad
                y acceso verificado.
              </p>
            </div>

            <button
              aria-expanded="false"
              aria-controls="faq3"
              class="cursor-pointer font-semibold mb-5 pt-5 border-t border-dark w-full flex justify-between items-center text-left"
            >
              ¿Cómo funciona el servicio de staking en Fundfy?
              <span class="inline-block rotate-90">➔</span>
            </button>
            <div id="faq3" class="panel" role="region" aria-hidden="true">
              <p class="pb-5">
                Fundfy permite la custodia tanto de activos tradicionales como
                digitales, incluyendo criptomonedas, brindando máxima seguridad
                y acceso verificado.
              </p>
            </div>

            <button
              aria-expanded="false"
              aria-controls="faq4"
              class="cursor-pointer font-semibold mb-5 pt-5 border-t border-dark w-full flex justify-between items-center text-left"
            >
              ¿Cómo puedo unirme y empezar a invertir con Fundfy?
              <span class="inline-block rotate-90">➔</span>
            </button>
            <div id="faq4" class="panel" role="region" aria-hidden="true">
              <p class="pb-5">
                Fundfy permite la custodia tanto de activos tradicionales como
                digitales, incluyendo criptomonedas, brindando máxima seguridad
                y acceso verificado.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  import { gsap, Power1, Elastic } from "gsap";

  document.addEventListener("DOMContentLoaded", () => {
    const buttons = document.querySelectorAll(".accordion > button");

    buttons.forEach((btn) => {
      const panelId = btn.getAttribute("aria-controls");
      if (!panelId) return;
      const panel = document.getElementById(panelId);
      const icon = btn.querySelector("span");
      if (!panel || !icon) return;

      gsap.set(panel, { height: 0, overflow: "hidden", opacity: 0 });

      btn.addEventListener("click", () => {
        const isOpen = btn.getAttribute("aria-expanded") === "true";

        buttons.forEach((otherBtn) => {
          if (otherBtn !== btn) {
            const otherPanelId = otherBtn.getAttribute("aria-controls");
            if (!otherPanelId) return;
            const otherPanel = document.getElementById(otherPanelId);
            const otherIcon = otherBtn.querySelector("span");
            if (!otherPanel || !otherIcon) return;
            otherBtn.setAttribute("aria-expanded", "false");
            otherPanel.setAttribute("aria-hidden", "true");
            gsap.to(otherPanel, {
              height: 0,
              opacity: 0,
              duration: 0.5,
              ease: Power1.easeInOut,
            });
            gsap.to(otherIcon, {
              rotation: 90,
              duration: 0.3,
              ease: Power1.easeInOut,
            });
          }
        });

        if (!isOpen) {
          btn.setAttribute("aria-expanded", "true");
          panel.setAttribute("aria-hidden", "false");

          const autoHeight = panel.scrollHeight;

          gsap.to(panel, {
            height: autoHeight,
            opacity: 1,
            duration: 0.8,
            ease: Elastic.easeOut.config(1, 0.5),
          });
          gsap.to(icon, {
            rotation: 270,
            duration: 0.5,
            ease: Power1.easeOut,
          });
        } else {
          btn.setAttribute("aria-expanded", "false");
          panel.setAttribute("aria-hidden", "true");

          gsap.to(panel, {
            height: 0,
            opacity: 0,
            duration: 0.5,
            ease: Power1.easeInOut,
          });
          gsap.to(icon, {
            rotation: 90,
            duration: 0.3,
            ease: Power1.easeInOut,
          });
        }
      });
    });
  });
</script>
